{"ast":null,"code":"var _jsxFileName = \"/Users/gkzhou/Dropbox/Code/leafletnotebook/src/components/Tools.jsx\";\nimport React from 'react';\nimport UploadNotes from './UploadNotes';\nimport UploadAudio from './UploadAudio';\nimport TextEditor from './TextEditor';\nimport News from './News';\nimport QuoteBank from './QuoteBank';\nimport { Grid, Menu, Header, Segment, Modal, Tab, Button, Icon } from 'semantic-ui-react';\n\nclass Tools extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.addHighlight = event => {\n      console.log(event.target.currentTime);\n      var allTimes = this.props.timestamps,\n          goal = event.target.currentTime;\n      var closestTime = allTimes.reduce(function (prev, curr) {\n        return Math.abs(curr - goal) < Math.abs(prev - goal) ? curr : prev;\n      });\n      var wordIndex = this.props.timestamps.indexOf(closestTime).toString();\n      var wordToHighlight = this.refs[\"word\" + wordIndex].innerText;\n      this.setState({\n        highlighted: wordToHighlight\n      });\n    };\n\n    this.state = {\n      title: \"\",\n      quotes: \"\",\n      audioURL: '',\n      // added\n      audioText: ['1::  Okay, we can just I definitely do think ', \"2:: that my time here. I've definitely felt like my disability has been more of a concern in the end, you know that in a positive way. Like I feel more looked after then I \", \"1:: have an any educational institution. That's wonderful. That's crazy. And even like like this is such a good dumb example, but like on like the row every house is accessible at least the first floor. Oh, wow, like that's not something that you will find. \", '2:: Our ', \"1:: universities. Yeah, and so the idea like even like if I don't \", \"2:: want to go like I'd say, I don't want to go to a party like I don't know but the idea \", \"1:: that I it's it's a choice I get to make whether I \", \"2:: want to go or not, right? That's a really large. Yeah privilege. I don't I wouldn't have gotten really anywhere \", \"1:: else. Yeah, like that's awesome. Yeah, I didn't even realize that that's right. Like I because I was driving to the like the dumb president reception. That was such a dumb event. Oh, yeah, you guys had to go to the\"],\n      timestamps: [],\n      roundedTimestamps: [],\n      uploaded: \"false\",\n      imageURL: '',\n      imageText: '',\n      uploadedNotes: \"true\",\n      // TRUE FOR DEMO, CHANGE TO FALSE FOR REAL USE\n      highlighted: \"fox\"\n    };\n    this.handleResultChange = this.handleResultChange.bind(this);\n    this.handleUpload = this.handleUpload.bind(this);\n    this.handleHighlightClick = this.handleHighlightClick.bind(this);\n    this.setRef = this.setRef.bind(this);\n  }\n\n  componentDidMount() {\n    // Calling a function on the Child DOM element\n    this.uploadInput.focus();\n  }\n\n  handleUploadAudio(ev) {\n    //added\n    ev.preventDefault();\n    const data = new FormData();\n    data.append('file', this.uploadInput.files[0]);\n    fetch('http://localhost:5000/upload', {\n      method: 'POST',\n      body: data\n    }).then(response => {\n      response.json().then(body => {\n        console.log(body.text);\n        this.setState({\n          audioURL: \"http://localhost:5000/static/\" + body.filename,\n          audioText: body.text,\n          timestamps: body.timestamps,\n          uploaded: \"true\"\n        });\n        console.log(\"before rounding\");\n        var roundedTimestamps = [];\n\n        if (this.state.timestamps.length > 0) {\n          this.state.timestamps.forEach(roundTimestamps);\n        }\n\n        function roundTimestamps(item) {\n          roundedTimestamps.push(Math.round(item));\n        }\n\n        this.setState({\n          roundedTimestamps: roundedTimestamps\n        });\n        console.log(this.state.roundedTimestamps);\n        console.log(\"Video transcript: \" + this.state.audioText);\n        console.log(\"Timestamps: \" + this.state.timestamps);\n      });\n    });\n  }\n\n  handleUploadImage(ev) {\n    ev.preventDefault();\n    const data = new FormData();\n    data.append('file', this.uploadInput.files[0]);\n    fetch('http://localhost:5000/upload', {\n      method: 'POST',\n      body: data\n    }).then(response => {\n      response.json().then(body => {\n        console.log(body.text);\n        this.setState({\n          imageURL: \"http://localhost:5000/static/\" + body.filename,\n          imageText: body.text,\n          uploadedNotes: \"true\"\n        });\n        console.log(this.state.imageText);\n      });\n    });\n  }\n\n  handleClickDemo() {\n    this.setState({\n      uploadedNotes: \"true\"\n    });\n  }\n\n  setRef(ref) {\n    this.uploadInput = ref;\n  }\n\n  handleResultChange(data) {\n    data = data.substring(0, data.indexOf(\".flac\"));\n    this.setState({\n      title: data\n    });\n  }\n\n  handleUpload() {\n    this.setState({\n      uploaded: \"true\"\n    });\n  }\n\n  handleHighlightClick() {\n    this.setState({\n      quotes: \"There are certain things that jump out to me about these incidents.\"\n    }, function () {\n      console.log(\"added\");\n    });\n  }\n\n  componentDidMount() {\n    document.addEventListener(\"keydown\", this.keyPress, false);\n    this.audio.addEventListener(\"timeupdate\", this.addHighlight, false);\n  }\n\n  componentWillUnmount() {\n    document.removeEventListener(\"keydown\", this.keyPress, false);\n    this.audio.removeEventListener(\"timeupdate\", this.addHighlight, false);\n  }\n\n  playWord(event) {\n    // plays word when clicked, only works for audio files < 1 min\n    const id = event.target.id;\n    const seconds = parseInt(this.props.timestamps[id]);\n    this.audio.currentTime = seconds;\n    this.audio.autoplay = true;\n  }\n\n  render() {\n    return React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 159\n      },\n      __self: this\n    }, React.createElement(Grid, {\n      columns: 2,\n      style: {\n        margin: '10px'\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 160\n      },\n      __self: this\n    }, React.createElement(Grid.Row, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 161\n      },\n      __self: this\n    }, React.createElement(Grid.Column, {\n      width: 11,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 162\n      },\n      __self: this\n    }, React.createElement(Menu, {\n      secondary: true,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 163\n      },\n      __self: this\n    }, React.createElement(Menu.Item, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 164\n      },\n      __self: this\n    }, React.createElement(\"span\", {\n      className: \"large-text\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 165\n      },\n      __self: this\n    }, \"Leaflet\")), React.createElement(Menu.Item, {\n      position: \"right\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 167\n      },\n      __self: this\n    }, this.state.uploaded && this.state.uplaodedNotes && React.createElement(Modal, {\n      style: {\n        alignItems: 'center',\n        margin: 'auto'\n      },\n      trigger: React.createElement(Button, {\n        className: \"light-green-btn\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 168\n        },\n        __self: this\n      }, \"Upload\"),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 168\n      },\n      __self: this\n    }, React.createElement(Header, {\n      icon: \"upload\",\n      content: \"Upload Audio and Notes\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 169\n      },\n      __self: this\n    }), React.createElement(Modal.Description, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 170\n      },\n      __self: this\n    }, React.createElement(\"button\", {\n      type: \"submit\",\n      class: \"ui blue button\",\n      onClick: this.handleUpload,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 171\n      },\n      __self: this\n    }, \"Transcribe audio\"))))), React.createElement(UploadAudio, {\n      onDataFetched: this.handleResultChange,\n      title: this.state.title,\n      setRef: this.setRef,\n      handleUploadAudio: this.handleUploadAudio.bind(this),\n      audioURL: this.state.audioURL,\n      audioText: this.state.audioText,\n      timestamps: this.state.timestamps,\n      roundedTimestamps: this.state.roundedTimestamps,\n      uploaded: this.state.uploaded,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 182\n      },\n      __self: this\n    }), React.createElement(TextEditor, {\n      audioText: this.state.audioText.join(),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 223\n      },\n      __self: this\n    })), React.createElement(Grid.Column, {\n      width: 5,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 226\n      },\n      __self: this\n    }, React.createElement(\"span\", {\n      className: \"green-background\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 227\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"smallMargin\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 228\n      },\n      __self: this\n    }, React.createElement(Tab, {\n      menu: {\n        secondary: true,\n        pointing: true\n      },\n      renderActiveOnly: false,\n      panes: [{\n        menuItem: 'Notes',\n        pane: React.createElement(Tab.Pane, {\n          style: {\n            maxHeight: \"90vh\",\n            overflow: \"auto\"\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 232\n          },\n          __self: this\n        }, React.createElement(UploadNotes, {\n          onDataFetched: this.handleResultChange,\n          title: this.state.title,\n          setRef: this.setRef,\n          handleUploadImage: this.handleUploadImage.bind(this),\n          imageURL: this.state.imageURL,\n          imageText: this.state.image,\n          timestamps: this.state.timestamps,\n          roundedTimestamps: this.state.roundedTimestamps,\n          uploaded: this.state.uploadedNotes,\n          handleClickDemo: this.state.handleClickDemo,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 233\n          },\n          __self: this\n        }))\n      }, {\n        menuItem: 'Quote Bank',\n        pane: React.createElement(Tab.Pane, {\n          attached: true,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 246\n          },\n          __self: this\n        }, React.createElement(\"div\", {\n          style: {\n            minHeight: \"80vh\",\n            maxHeight: \"90vh\",\n            overflow: \"auto\"\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 246\n          },\n          __self: this\n        }, React.createElement(QuoteBank, {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 246\n          },\n          __self: this\n        })))\n      }, {\n        menuItem: 'Related News',\n        pane: React.createElement(Tab.Pane, {\n          attached: true,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 247\n          },\n          __self: this\n        }, React.createElement(\"div\", {\n          style: {\n            maxHeight: \"90vh\",\n            overflow: \"auto\"\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 247\n          },\n          __self: this\n        }, React.createElement(News, {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 247\n          },\n          __self: this\n        })), \" \")\n      }],\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 229\n      },\n      __self: this\n    }))))), React.createElement(\"figure\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 255\n      },\n      __self: this\n    }, React.createElement(\"audio\", {\n      id: \"audio\",\n      ref: audio => {\n        this.audio = audio;\n      },\n      controls: true,\n      currentTime: \"5\",\n      src: \"http://localhost:5000/static/fieldinterview.flac\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 256\n      },\n      __self: this\n    }, \" \", \"Your browser does not support the\", React.createElement(\"code\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 259\n      },\n      __self: this\n    }, \"audio\"), \" element.\"))));\n  }\n\n}\n\nexport default Tools;","map":{"version":3,"sources":["/Users/gkzhou/Dropbox/Code/leafletnotebook/src/components/Tools.jsx"],"names":["React","UploadNotes","UploadAudio","TextEditor","News","QuoteBank","Grid","Menu","Header","Segment","Modal","Tab","Button","Icon","Tools","Component","constructor","props","addHighlight","event","console","log","target","currentTime","allTimes","timestamps","goal","closestTime","reduce","prev","curr","Math","abs","wordIndex","indexOf","toString","wordToHighlight","refs","innerText","setState","highlighted","state","title","quotes","audioURL","audioText","roundedTimestamps","uploaded","imageURL","imageText","uploadedNotes","handleResultChange","bind","handleUpload","handleHighlightClick","setRef","componentDidMount","uploadInput","focus","handleUploadAudio","ev","preventDefault","data","FormData","append","files","fetch","method","body","then","response","json","text","filename","length","forEach","roundTimestamps","item","push","round","handleUploadImage","handleClickDemo","ref","substring","document","addEventListener","keyPress","audio","componentWillUnmount","removeEventListener","playWord","id","seconds","parseInt","autoplay","render","margin","uplaodedNotes","alignItems","join","secondary","pointing","menuItem","pane","maxHeight","overflow","image","minHeight"],"mappings":"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","sourcesContent":["import React from 'react';\nimport UploadNotes from './UploadNotes'\nimport UploadAudio from './UploadAudio'\nimport TextEditor from './TextEditor'\nimport News from './News';\n\nimport QuoteBank from './QuoteBank';\nimport { Grid, Menu, Header, Segment, Modal, Tab, Button, Icon } from 'semantic-ui-react'\n\nclass Tools extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      title: \"\",\n      quotes: \"\",\n\n      audioURL: '', // added\n      audioText: ['1::  Okay, we can just I definitely do think ', \"2:: that my time here. I've definitely felt like my disability has been more of a concern in the end, you know that in a positive way. Like I feel more looked after then I \", \"1:: have an any educational institution. That's wonderful. That's crazy. And even like like this is such a good dumb example, but like on like the row every house is accessible at least the first floor. Oh, wow, like that's not something that you will find. \", '2:: Our ', \"1:: universities. Yeah, and so the idea like even like if I don't \", \"2:: want to go like I'd say, I don't want to go to a party like I don't know but the idea \", \"1:: that I it's it's a choice I get to make whether I \", \"2:: want to go or not, right? That's a really large. Yeah privilege. I don't I wouldn't have gotten really anywhere \", \"1:: else. Yeah, like that's awesome. Yeah, I didn't even realize that that's right. Like I because I was driving to the like the dumb president reception. That was such a dumb event. Oh, yeah, you guys had to go to the\"],\n      timestamps: [],\n      roundedTimestamps: [],\n      uploaded: \"false\",\n\n      imageURL: '',\n      imageText: '',\n      uploadedNotes: \"true\", // TRUE FOR DEMO, CHANGE TO FALSE FOR REAL USE\n\n      highlighted: \"fox\"\n    };\n    this.handleResultChange = this.handleResultChange.bind(this);\n    this.handleUpload = this.handleUpload.bind(this);\n    this.handleHighlightClick = this.handleHighlightClick.bind(this);\n    this.setRef = this.setRef.bind(this);\n  }\n\n  componentDidMount() {\n    // Calling a function on the Child DOM element\n    this.uploadInput.focus();\n  }\n\n\n  handleUploadAudio(ev) { //added\n    ev.preventDefault();\n\n    const data = new FormData();\n    data.append('file', this.uploadInput.files[0]);\n\n    fetch('http://localhost:5000/upload', {\n      method: 'POST',\n      body: data,\n    }).then((response) => {\n      response.json().then((body) => {\n        console.log(body.text);\n        this.setState({\n          audioURL: \"http://localhost:5000/static/\" + body.filename,\n          audioText: body.text,\n          timestamps: body.timestamps,\n          uploaded: \"true\"\n        });\n        \n        console.log(\"before rounding\")\n        var roundedTimestamps = [];\n        if (this.state.timestamps.length > 0) {\n          this.state.timestamps.forEach(roundTimestamps);\n        }\n        function roundTimestamps(item) {\n          roundedTimestamps.push(Math.round(item));\n        }\n        this.setState({ roundedTimestamps: roundedTimestamps });\n\n        console.log(this.state.roundedTimestamps)\n\n        console.log(\"Video transcript: \" + this.state.audioText);\n        console.log(\"Timestamps: \" + this.state.timestamps);\n      });\n    });\n  }\n\n  handleUploadImage(ev) {\n    ev.preventDefault();\n\n    const data = new FormData();\n    data.append('file', this.uploadInput.files[0]);\n\n    fetch('http://localhost:5000/upload', {\n      method: 'POST',\n      body: data,\n    }).then((response) => {\n      response.json().then((body) => {\n        console.log(body.text);\n        this.setState({\n          imageURL: \"http://localhost:5000/static/\" + body.filename,\n          imageText: body.text,\n          uploadedNotes: \"true\"\n        });\n        console.log(this.state.imageText);\n      });\n    });\n  }\n\n  handleClickDemo() {\n    this.setState({\n      uploadedNotes: \"true\"\n    });\n  }\n\n  setRef(ref) {\n    this.uploadInput = ref;\n  }\n\n  handleResultChange(data) {\n    data = data.substring(0, data.indexOf(\".flac\"));\n    this.setState({\n      title: data\n    });\n  }\n\n  handleUpload() {\n    this.setState({\n      uploaded: \"true\"\n    });\n  }\n\n  handleHighlightClick() {\n    this.setState({ quotes: \"There are certain things that jump out to me about these incidents.\" }, function () {\n      console.log(\"added\");\n    });\n  }\n\n  addHighlight = (event) => {\n    console.log(event.target.currentTime)\n      var allTimes = this.props.timestamps,\n        goal = event.target.currentTime;\n\n      var closestTime = allTimes.reduce(function (prev, curr) {\n        return (Math.abs(curr - goal) < Math.abs(prev - goal) ? curr : prev);\n      });\n\n      var wordIndex = this.props.timestamps.indexOf(closestTime).toString();\n      var wordToHighlight = this.refs[\"word\" + wordIndex].innerText;\n      this.setState({ highlighted: wordToHighlight });\n  }\n\n  componentDidMount() {\n    document.addEventListener(\"keydown\", this.keyPress, false);\n    this.audio.addEventListener(\"timeupdate\", this.addHighlight, false);\n  }\n  componentWillUnmount() {\n    document.removeEventListener(\"keydown\", this.keyPress, false);\n    this.audio.removeEventListener(\"timeupdate\", this.addHighlight, false);\n  }\n  playWord(event) { // plays word when clicked, only works for audio files < 1 min\n    const id = event.target.id;\n    const seconds = parseInt(this.props.timestamps[id]);\n    this.audio.currentTime = seconds;\n    this.audio.autoplay = true;\n  }\n  render() {\n    return (\n      <div>\n        <Grid columns={2} style={{ margin: '10px' }}>\n          <Grid.Row>\n            <Grid.Column width={11}>\n              <Menu secondary>\n                <Menu.Item>\n                  <span className=\"large-text\">Leaflet</span>\n                </Menu.Item>\n                <Menu.Item position='right'>\n                  {this.state.uploaded && this.state.uplaodedNotes && <Modal style={{ alignItems: 'center', margin: 'auto', }} trigger={<Button className=\"light-green-btn\">Upload</Button>}>\n                    <Header icon='upload' content='Upload Audio and Notes' />\n                    <Modal.Description>\n                      <button type=\"submit\" class=\"ui blue button\" onClick={this.handleUpload}>\n                        Transcribe audio\n                </button>\n                      \n                    </Modal.Description>\n                  </Modal>}\n                </Menu.Item>\n              </Menu>\n\n          \n\n              <UploadAudio\n                onDataFetched={this.handleResultChange}\n                title={this.state.title}\n                setRef={this.setRef}\n                handleUploadAudio={this.handleUploadAudio.bind(this)}\n                audioURL={this.state.audioURL}\n                audioText={this.state.audioText}\n                timestamps={this.state.timestamps}\n                roundedTimestamps={this.state.roundedTimestamps}\n                uploaded={this.state.uploaded}\n              />\n              {/*}\n              <Segment className=\"no-border\" style={{ overflow: 'auto', maxHeight: '90vh' }}>\n                <div style={{ display: \"flex\", flexDirection: \"row\", justifyContent: \"space-between\" }}>\n                  <h2>{this.state.title}</h2>\n                  <div className=\"right-btn\">\n                    <Button icon size='mini' onClick={this.downloadTxtFile}><Icon name='share square outline icon' /></Button>\n                  </div>\n                </div>\n                <UploadAudio onDataFetched={this.handleResultChange} />\n              </Segment>\n\n    */}\n              {/* FOR DEMO PURPOSES!!!\n            <button type=\"submit\" class=\"ui button\" class=\"ui blue button\" onClick={this.handleUpload}>\n            <i class=\"upload icon\"></i> Upload and Transcribe\n            </button>\n                {this.state.uploaded == \"true\" && <div>\n                <p>SHAPIRO: You were one of 18 people in the top one-tenth of 1% who signed a letter supporting a wealth tax for households with $50 million or more in assets. Just briefly, why?</p>\n    <p>DISNEY: Well, nothing in history ever moved forward just because people advocated for their own interests. Things really change when people are traitors to their class. And my class needs some really good traitors these days.</p>\n    <p>SHAPIRO: Have you been treated as a traitor for signing this letter?</p>\n    <p>DISNEY: Oh, my goodness gracious, yes.</p>\n    <p>SHAPIRO: Really?</p>\n    <p>DISNEY: But, you know, it is just really important. We're not in a democracy all assigned with the task of advocating for ourselves. We're assigned with the task of trying to create the best and strongest and fairest country we can create. And what I've watched over the last 30 years is rich people going from terribly rich to awfully rich to obscenely and insanely rich. And we have to draw a line.</p>\n    <p>SHAPIRO: If you and your cohort of wealthy individuals gave your money to philanthropic causes instead of being taxed, you could direct it to education or homelessness or whatever your cause may be. Why would you rather see it go to the federal government?</p>\n    <p>DISNEY: Here's the world I want to live in. I want to live in a world that doesn't need philanthropy. And if Jeff Bezos earned less and paid his people more and didn't have $37 billion to put into a philanthropy and figure out what to do with, there really wouldn't be that much of the philanthropy that was needed. I would rather not to be needed as a philanthropist. And I will never stop feeding the hungry and housing the homeless and all the other things that I want to do.</p>\n    <p>But I would so much prefer that public schools function, that roads don't break your axles, you know, that people have health care - which they have a right to have - that low-income people who work full-time at minimum wage don't need food stamps to get through their days. That's the world I want to live in.</p>\n    <p>SHAPIRO: On an issue that is related but separate, I want to ask about your very public criticism of the current CEO of Disney for his compensation package. You have no formal role with the Disney Company. For people who have not been following this very public back-and-forth, what is the nut of your critique here?</p>\n    <p>DISNEY: The nut of my critique is that I know that company pretty well? Obviously, it's a big, sophisticated company. And it's grown a lot since I, you know, worked sort of in a way with it. When you're in what is setting up to be the largest media and entertainment conglomerate on the planet in the history of the world...</p>   </div>} \n    */}\n\n            <TextEditor audioText={this.state.audioText.join()}/> \n            </Grid.Column>\n\n            <Grid.Column width={5}>\n              <span className=\"green-background\">\n                <div className=\"smallMargin\">\n                  <Tab menu={{ secondary: true, pointing: true }} renderActiveOnly={false} \n                    panes={[\n                      {\n                        menuItem: 'Notes', pane: <Tab.Pane style={{ maxHeight: \"90vh\", overflow: \"auto\"}}>\n                          <UploadNotes\n                        onDataFetched={this.handleResultChange}\n                        title={this.state.title}\n                        setRef={this.setRef}\n                        handleUploadImage={this.handleUploadImage.bind(this)}\n                        imageURL={this.state.imageURL}\n                        imageText={this.state.image}\n                        timestamps={this.state.timestamps}\n                        roundedTimestamps={this.state.roundedTimestamps}\n                        uploaded={this.state.uploadedNotes} \n                        handleClickDemo={this.state.handleClickDemo}/>\n                        </Tab.Pane>\n                      },\n                      { menuItem: 'Quote Bank', pane: <Tab.Pane attached><div style={{ minHeight: \"80vh\", maxHeight: \"90vh\", overflow: \"auto\" }}><QuoteBank /></div></Tab.Pane> },\n                      { menuItem: 'Related News', pane: <Tab.Pane attached><div style={{ maxHeight: \"90vh\", overflow: \"auto\" }}><News /></div> </Tab.Pane>},\n                    ]}\n                  />\n                </div>\n              </span>\n            </Grid.Column>\n\n          </Grid.Row>\n          <figure>\n            <audio id=\"audio\" ref={(audio) => { this.audio = audio }} controls currentTime=\"5\"\n              src=\"http://localhost:5000/static/fieldinterview.flac\"> {/*{this.props.audioURL} FOR FINAL*/}\n              Your browser does not support the\n              <code>audio</code> element.\n              </audio>\n          </figure>\n        </Grid>\n      </div>\n    );\n  }\n}\n\nexport default Tools;"]},"metadata":{},"sourceType":"module"}